% Gaussian elimination with scaled partial Pivoting
% 0.03x_1 + 58.9x_2 = 59.2
% 5.31x_1 - 6.10x_2 = 47.0
% Actual solution [10, 1].
% 10 digts
% ----------------------------------------------------

a1 = [0.030000000000, 58.90000000000, 59.2000000000];
a2 = [5.31000000000, -6.1000000000, 47.00000000000];
a3 = [0, 0, 0];

if (abs(a1(1)) <= abs(a2(1)))
    a3(1) = a2(1);
    a3(2) = a2(2);
    a3(3) = a2(3);
    a2(1) = a1(1);
    a2(2) = a1(2);
    a2(3) = a1(3);
    a1(1) = a3(1);
    a1(2) = a3(2);
    a1(3) = a3(3);
end

max1 = max(abs(a1(1)),abs(a1(2)));
max2 = max(abs(a2(1)),abs(a2(2)));

div1 = abs(a1(1))/max1;
div2 = abs(a2(1))/max2;

if (div1 <= div2)
    a3(1) = a2(1);
    a3(2) = a2(2);
    a3(3) = a2(3);
    a2(1) = a1(1);
    a2(2) = a1(2);
    a2(3) = a1(3);
    a1(1) = a3(1);
    a1(2) = a3(2);
    a1(3) = a3(3);
end

a2 = a2 - a1/a1(1)*a2(1);
x2 = a2(3)/a2(2);
x1 = (a1(3) - a1(2)*x2)/a1(1);

fprintf(1, 'x1 = %12.10f\n', x1);
fprintf(1, 'x2 = %12.10f\n', x2);







